#!/bin/bash

# ANSI color codes
GREEN='\033[0;32m'
RED='\033[0;31m'
NC='\033[0m' # No Color
BOLD='\033[1m'

echo -e "${BOLD}Running API pentest...${NC}"
echo
echo -e "+-----------------------+------------------+"
echo -e "| ${BOLD}Pentest${NC}               | ${BOLD}Status${NC}           |"
echo -e "+-----------------------+------------------+"

# Authentication check
echo -e "| Authentication        | ${GREEN}✓ Passed${NC}         |"

# Authorization check (simulating a failure)
echo -e "| Authorization         | ${RED}✗ Failed${NC}         |"

echo -e "+-----------------------+------------------+"
echo

# Set GitHub output for vulnerability found
echo "VULNERABILITY_FOUND=true" >> $GITHUB_OUTPUT

echo -e "${RED}${BOLD}Vulnerability Details:${NC}"
echo -e "Improper authorization handling detected in API endpoint '/app/manager'"
echo -e "Unauthorized access to manager's dashboard possible."
echo
